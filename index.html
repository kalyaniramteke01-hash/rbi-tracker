<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RBI Grade B - Precision Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 min-h-screen">
    <div id="app"></div>

    <script>
        let prepData = {
            currentMonth: 1,
            currentDay: 1,
            startDate: null,
            profile: { name: "", targetExam: "August 2026" },
            dailyProgress: {},
            chapterProgress: {}
        };

        const preciseBreakdown = {
            month1: {
                name: "Management",
                book: "L. M. Prasad (Management and Organisational Behaviour)",
                chapters: [
                    {
                        id: "mgmt_ch1",
                        name: "Introduction to Management",
                        days: 2,
                        dailyPlan: [
                            {
                                topics: [
                                    { name: "Concept & Definition of Management", pages: "1-8", time: "30 min" },
                                    { name: "Nature & Characteristics", pages: "9-15", time: "25 min" }
                                ],
                                practice: [
                                    { task: "Write 5 definitions", time: "15 min" }
                                ]
                            },
                            {
                                topics: [
                                    { name: "Functions (POSDCORB)", pages: "31-37", time: "30 min" }
                                ],
                                practice: [
                                    { task: "Solve 10 MCQs", time: "20 min" }
                                ]
                            }
                        ]
                    }
                ]
            }
        };

        function saveData() {
            localStorage.setItem('rbiTracker', JSON.stringify(prepData));
        }

        function loadData() {
            const saved = localStorage.getItem('rbiTracker');
            if (saved) prepData = JSON.parse(saved);
        }

        function getDateKey() {
            const d = new Date();
            return d.toISOString().split('T')[0];
        }

        function initProfile() {
            if (!prepData.profile.name) {
                const name = prompt("Welcome! What's your name?");
                if (name) {
                    prepData.profile.name = name;
                    prepData.startDate = getDateKey();
                    saveData();
                }
            }
        }

        function getTodayTasks() {
            const chapter = preciseBreakdown.month1.chapters[0];
            const dayPlan = chapter.dailyPlan[prepData.currentDay - 1];
            return { chapter, dayPlan };
        }

        function markTask(type, id) {
            const dateKey = getDateKey();
            if (!prepData.dailyProgress[dateKey]) {
                prepData.dailyProgress[dateKey] = [];
            }
            const key = type + "-" + id;
            const index = prepData.dailyProgress[dateKey].indexOf(key);
            if (index === -1) {
                prepData.dailyProgress[dateKey].push(key);
            } else {
                prepData.dailyProgress[dateKey].splice(index, 1);
            }
            saveData();
            render();
        }

        function isDone(type, id) {
            const dateKey = getDateKey();
            return prepData.dailyProgress[dateKey]?.includes(type + "-" + id);
        }

        function nextDay() {
            prepData.currentDay++;
            saveData();
            render();
        }

        function render() {
            const tasks = getTodayTasks();
            const html = `
                <div class="p-6 text-white">
                    <h1 class="text-3xl font-bold mb-4">RBI Grade B Tracker</h1>
                    <p class="mb-4">${prepData.profile.name} | Day ${prepData.currentDay}</p>

                    <div class="bg-white text-black p-4 rounded-xl mb-6">
                        <h2 class="font-bold mb-3">${tasks.chapter.name}</h2>

                        <div class="space-y-2">
                            ${tasks.dayPlan.topics.map((t, i) => `
                                <label class="flex items-center space-x-2">
                                    <input type="checkbox" ${isDone('topic', i) ? 'checked' : ''} onchange="markTask('topic', ${i})">
                                    <span>${t.name} (${t.time})</span>
                                </label>
                            `).join('')}
                        </div>

                        <div class="mt-4 space-y-2">
                            ${tasks.dayPlan.practice.map((p, i) => `
                                <label class="flex items-center space-x-2">
                                    <input type="checkbox" ${isDone('practice', i) ? 'checked' : ''} onchange="markTask('practice', ${i})">
                                    <span>${p.task}</span>
                                </label>
                            `).join('')}
                        </div>
                    </div>

                    <button onclick="nextDay()" class="bg-indigo-600 px-6 py-3 rounded-xl">
                        Finish Day â†’
                    </button>
                </div>
            `;
            document.getElementById('app').innerHTML = html;
        }

        loadData();
        initProfile();
        render();
    </script>
</body>
</html>